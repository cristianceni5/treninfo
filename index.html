<!DOCTYPE html>
<html lang="it">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Treninfo Server</title>
</head>
<body>
  <h1>Treninfo Server</h1>
  <p>Backend API (Netlify Functions) che normalizza i dati e restituisce JSON pronti per l'app Treninfo.</p>
  <ul>
    <li><a href="/test-rfi.html">Pagina di test chiamate API</a></li>
    <li><a href="/docs/SERVER-TRENINFO.md">Guida rapida (repo)</a></li>
    <li><a href="/docs/API.md">Documentazione API</a></li>
  </ul>
  <p>Base path API: <code>/api</code></p>

  <hr />

  <section>
    <h2>Come funziona (stazioni e treni)</h2>

    <h3>Stazioni</h3>
    <table border="1" cellpadding="6" cellspacing="0">
      <thead>
        <tr>
          <th>Cosa</th>
          <th>Come funziona</th>
        </tr>
      </thead>
      <tbody>
        <tr>
          <td>Output API</td>
          <td>Le stazioni nelle risposte sono <b>stringhe</b> (nome canonico).</td>
        </tr>
        <tr>
          <td>ID esposti</td>
          <td>Non vengono restituiti codici RFI (<code>Sxxxxx</code>) né <code>lefrecceId</code>.</td>
        </tr>
        <tr>
          <td>Input consigliato</td>
          <td>Usa <code>stationName</code> negli endpoint stazione.</td>
        </tr>
        <tr>
          <td>Autocomplete</td>
          <td><code>/api/viaggiatreno/autocomplete</code> restituisce direttamente una lista di nomi stazione.</td>
        </tr>
        <tr>
          <td>Normalizzazione</td>
          <td>Il backend mappa/normalizza i nomi usando il DB interno e fa matching “tollerante” (sigle, punti, ecc.).</td>
        </tr>
      </tbody>
    </table>

    <h3>Tipi treno (normalizzazione)</h3>
    <p>Il backend riconosce e normalizza la sigla <code>categoria</code> e il blocco <code>tipoTreno</code>.</p>
    <table border="1" cellpadding="6" cellspacing="0">
      <thead>
        <tr>
          <th>Input (rilevato)</th>
          <th>Output <code>categoria</code></th>
          <th><code>tipoTreno.categoria</code></th>
          <th>Note</th>
        </tr>
      </thead>
      <tbody>
        <tr>
          <td><code>FRECCIAROSSA</code>, <code>FR</code></td>
          <td><code>FR</code></td>
          <td><code>high-speed</code></td>
          <td>Frecciarossa</td>
        </tr>
        <tr>
          <td><code>FRECCIARGENTO</code>, <code>FA</code></td>
          <td><code>FA</code></td>
          <td><code>high-speed</code></td>
          <td>Frecciargento</td>
        </tr>
        <tr>
          <td><code>ITALO</code>, <code>NTV</code>, <code>ITA</code></td>
          <td><code>ITA</code></td>
          <td><code>high-speed</code></td>
          <td>Italo</td>
        </tr>
        <tr>
          <td><code>INTERCITY</code>, <code>IC</code></td>
          <td><code>IC</code></td>
          <td><code>intercity</code></td>
          <td>Intercity</td>
        </tr>
        <tr>
          <td><code>INTERCITY NOTTE</code>, <code>ICN</code></td>
          <td><code>ICN</code></td>
          <td><code>intercity</code></td>
          <td>Intercity Notte</td>
        </tr>
        <tr>
          <td><code>EUROCITY</code>, <code>EC</code></td>
          <td><code>EC</code></td>
          <td><code>intercity</code></td>
          <td>Eurocity (fa parte degli intercity)</td>
        </tr>
        <tr>
          <td><code>FRECCIABIANCA</code>, <code>FB</code></td>
          <td><code>FB</code></td>
          <td><code>intercity</code></td>
          <td>Frecciabianca</td>
        </tr>
        <tr>
          <td><code>REGIONALE</code>, <code>REG</code>, <code>RV</code>, <code>R</code>, <code>RE</code></td>
          <td><code>REG</code></td>
          <td><code>regional</code></td>
          <td>Tutte le varianti regionali vengono normalizzate a <code>REG</code></td>
        </tr>
        <tr>
          <td><code>BUS</code>, <code>SOSTITUTIVO</code></td>
          <td><code>BUS</code></td>
          <td><code>bus</code></td>
          <td>Bus sostitutivi</td>
        </tr>
        <tr>
          <td>(altro)</td>
          <td><code>?</code></td>
          <td><code>unknown</code></td>
          <td>Non riconosciuto</td>
        </tr>
      </tbody>
    </table>
  </section>
</body>
</html>
